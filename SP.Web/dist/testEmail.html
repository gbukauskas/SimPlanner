<!DOCTYPE html>
<html>
<head>
    <title></title>
	<meta charset="utf-8" />
    <style>
        .success{background-color:lightyellow;color:green}
    </style>
</head>
<body>
    <div>
        <table>
            <thead>
                <tr><th>host</th><th>port</th><th>ssl</th><th>exception</th></tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
</body>
</html>
<script type="text/javascript">
    var oReq = new XMLHttpRequest();
    oReq.onreadystatechange = readyStateChange;
    oReq.open('GET', "/api/utilities/TestEmail", true);
    oReq.setRequestHeader('Accept', 'application/json');
    oReq.send();

    function readyStateChange() {
        var status;
        var data;
        // https://xhr.spec.whatwg.org/#dom-xmlhttprequest-readystate
        if (oReq.readyState == 4) { // `DONE`
            status = oReq.status;
            if (status == 200) {
                transferComplete(JSON.parse(oReq.responseText));
            } else {

            }
        }
    }

    function transferComplete(data) {
        var tbody = document.getElementsByTagName('tbody')[0];
        var props = ['Host','Port','SSL','ExceptionMsg']
        data.forEach(function (d) {
            var newRow = tbody.insertRow();

            props.forEach(function (p) {
                var newCell = newRow.insertCell();
                // Append a text node to the cell
                var text = d[p];
                if (text!==null) {
                    var newText = document.createTextNode(text);
                    newCell.appendChild(newText);
                } else if (p === 'ExceptionMsg') {
                    newRow.classList.add('success');
                }

            });

        });
    }
</script>